From ee0e9678e761e8a41cfffcb163de42967e5a1758 Mon Sep 17 00:00:00 2001
From: Justin Ruggles <justin.ruggles@gmail.com>
Date: Sun, 7 Oct 2012 21:19:28 -0400
Subject: [PATCH 109/278] amrwbdec: set channels, channel_layout, and
 sample_rate

Only mono 16kHz is supported.
---
 libavcodec/amrwbdec.c |   11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/libavcodec/amrwbdec.c b/libavcodec/amrwbdec.c
index c9c793f..9b0fe25 100644
--- a/libavcodec/amrwbdec.c
+++ b/libavcodec/amrwbdec.c
@@ -24,6 +24,7 @@
  * AMR wideband decoder
  */
 
+#include "libavutil/audioconvert.h"
 #include "libavutil/common.h"
 #include "libavutil/lfg.h"
 
@@ -90,7 +91,15 @@ static av_cold int amrwb_decode_init(AVCodecContext *avctx)
     AMRWBContext *ctx = avctx->priv_data;
     int i;
 
-    avctx->sample_fmt = AV_SAMPLE_FMT_FLT;
+    if (avctx->channels > 1) {
+        av_log_missing_feature(avctx, "multi-channel AMR", 0);
+        return AVERROR_PATCHWELCOME;
+    }
+
+    avctx->channels       = 1;
+    avctx->channel_layout = AV_CH_LAYOUT_MONO;
+    avctx->sample_rate    = 16000;
+    avctx->sample_fmt     = AV_SAMPLE_FMT_FLT;
 
     av_lfg_init(&ctx->prng, 1);
 
-- 
1.7.9.5

