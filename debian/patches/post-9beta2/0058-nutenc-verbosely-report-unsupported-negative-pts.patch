From 07585ffa62eebebcd35326935fec7cd948021daf Mon Sep 17 00:00:00 2001
From: Luca Barbato <lu_zero@gentoo.org>
Date: Sat, 27 Oct 2012 16:56:37 +0200
Subject: [PATCH 058/278] nutenc: verbosely report unsupported negative pts

Additionally use the correct error number.
---
 libavformat/nutenc.c |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/libavformat/nutenc.c b/libavformat/nutenc.c
index 581a202..e9e313b 100644
--- a/libavformat/nutenc.c
+++ b/libavformat/nutenc.c
@@ -767,8 +767,12 @@ static int nut_write_packet(AVFormatContext *s, AVPacket *pkt)
     int store_sp  = 0;
     int ret;
 
-    if (pkt->pts < 0)
-        return -1;
+    if (pkt->pts < 0) {
+        av_log(s, AV_LOG_ERROR,
+               "Negative pts not supported stream %d, pts %"PRId64"\n",
+               pkt->stream_index, pkt->pts);
+        return AVERROR_INVALIDDATA;
+    }
 
     if (1LL << (20 + 3 * nut->header_count) <= avio_tell(bc))
         write_headers(s, bc);
-- 
1.7.9.5

