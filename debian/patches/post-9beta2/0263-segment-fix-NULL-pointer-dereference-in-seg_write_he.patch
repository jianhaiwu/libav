From e8769b37fe8a841c0d28d3686c6d3cdecc542bc7 Mon Sep 17 00:00:00 2001
From: Xi Wang <xi.wang@gmail.com>
Date: Wed, 14 Nov 2012 02:52:32 -0500
Subject: [PATCH 263/278] segment: fix NULL pointer dereference in
 seg_write_header()
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Since the pointer `oc' is NULL, oc->oformat->name will cause a null
pointer dereference.  This patch changes it to seg->oformat->name.

Signed-off-by: Xi Wang <xi.wang@gmail.com>
Signed-off-by: Martin Storsj√∂ <martin@martin.st>
---
 libavformat/segment.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libavformat/segment.c b/libavformat/segment.c
index fd52835..8afb41f 100644
--- a/libavformat/segment.c
+++ b/libavformat/segment.c
@@ -210,7 +210,7 @@ static int seg_write_header(AVFormatContext *s)
     }
     if (seg->oformat->flags & AVFMT_NOFILE) {
         av_log(s, AV_LOG_ERROR, "format %s not supported.\n",
-               oc->oformat->name);
+               seg->oformat->name);
         ret = AVERROR(EINVAL);
         goto fail;
     }
-- 
1.7.9.5

