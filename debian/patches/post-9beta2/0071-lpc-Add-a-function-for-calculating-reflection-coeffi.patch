From 8b25a20efbf4ca261bcd3327a385330eca775ec6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Martin=20Storsj=C3=B6?= <martin@martin.st>
Date: Thu, 25 Oct 2012 15:33:15 +0300
Subject: [PATCH 071/278] lpc: Add a function for calculating reflection
 coefficients from samples
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Martin Storsj√∂ <martin@martin.st>
---
 libavcodec/lpc.c |   12 ++++++++++++
 libavcodec/lpc.h |    3 +++
 2 files changed, 15 insertions(+)

diff --git a/libavcodec/lpc.c b/libavcodec/lpc.c
index 126dbc1..2093e7e 100644
--- a/libavcodec/lpc.c
+++ b/libavcodec/lpc.c
@@ -148,6 +148,18 @@ static int estimate_best_order(double *ref, int min_order, int max_order)
     return est;
 }
 
+int ff_lpc_calc_ref_coefs(LPCContext *s,
+                          const int32_t *samples, int order, double *ref)
+{
+    double autoc[MAX_LPC_ORDER + 1];
+
+    s->lpc_apply_welch_window(samples, s->blocksize, s->windowed_samples);
+    s->lpc_compute_autocorr(s->windowed_samples, s->blocksize, order, autoc);
+    compute_ref_coefs(autoc, order, ref, NULL);
+
+    return order;
+}
+
 /**
  * Calculate LPC coefficients for multiple orders
  *
diff --git a/libavcodec/lpc.h b/libavcodec/lpc.h
index 0e54f0d..6590608 100644
--- a/libavcodec/lpc.h
+++ b/libavcodec/lpc.h
@@ -92,6 +92,9 @@ int ff_lpc_calc_coefs(LPCContext *s,
                       enum FFLPCType lpc_type, int lpc_passes,
                       int omethod, int max_shift, int zero_shift);
 
+int ff_lpc_calc_ref_coefs(LPCContext *s,
+                          const int32_t *samples, int order, double *ref);
+
 /**
  * Initialize LPCContext.
  */
-- 
1.7.9.5

