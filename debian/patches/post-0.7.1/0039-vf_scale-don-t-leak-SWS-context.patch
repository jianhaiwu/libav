From 2b74db8d2781202742535a466a371a10a108b141 Mon Sep 17 00:00:00 2001
From: Michael Niedermayer <michaelni@gmx.at>
Date: Wed, 9 Mar 2011 03:30:24 +0100
Subject: [PATCH 39/70] vf_scale: don't leak SWS context.

Signed-off-by: Anton Khirnov <anton@khirnov.net>
(cherry picked from commit 52982dbe474663709033e1ad259f8ff7a5a2eefa)

Signed-off-by: Anton Khirnov <anton@khirnov.net>
---
 libavfilter/vf_scale.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/libavfilter/vf_scale.c b/libavfilter/vf_scale.c
index 65fe01c..5288d32 100644
--- a/libavfilter/vf_scale.c
+++ b/libavfilter/vf_scale.c
@@ -205,6 +205,8 @@ static int config_props(AVFilterLink *outlink)
 
     scale->input_is_pal = av_pix_fmt_descriptors[inlink->format].flags & PIX_FMT_PAL;
 
+    if (scale->sws)
+        sws_freeContext(scale->sws);
     scale->sws = sws_getContext(inlink ->w, inlink ->h, inlink ->format,
                                 outlink->w, outlink->h, outlink->format,
                                 scale->flags, NULL, NULL, NULL);
-- 
1.7.4.1

